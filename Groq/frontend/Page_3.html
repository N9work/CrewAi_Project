<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Prompt:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Sour+Gummy:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <title>Trip Planner</title>
    <style>
        body {
            font-family: "Sour Gummy", serif;
            text-align: center;
            background-image: url('https://ik.imagekit.io/tvlk/blog/2020/09/%E0%B8%AB%E0%B8%A5%E0%B8%B5%E0%B9%80%E0%B8%9B%E0%B9%8A%E0%B8%B0-2.jpg?tr=q-70,c-at_max,w-500,h-300,dpr-2');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            height: 100vh;
            margin: 0;
        }

        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: inherit;
            filter: blur(5px);
            z-index: -1;
        }


        .container {
            background-color: #f0f0f0;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            max-width: 30%;
            margin: 5px auto;
            justify-content: center;
            align-items: center;
        }

        .sticker {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 100px;
            height: auto;
            z-index: 999;
        }

        .form-group {
            width: 100%;
            padding: 10px;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 16px;
            box-sizing: border-box;
        }

        .custom-box {
            display: flex;
            align-items: center;
            border: 2px solid #ccc;
            border-radius: 10px;
            padding: 15px;
            background-color: #f9f9f9;
            width: 90%;
        }

        .icon-box {
            width: 80px;
            height: 80px;
            background-color: #ddd;
            border-radius: 20%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
        }

        .icon {
            font-size: 40px;
        }

        .content-box {
            flex: 1;
        }

        h3 {
            font-size: 18px;
            margin: 0 0 10px 0;
            text-align: left;
        }

        select.custom-select {
            width: 100%;
            padding: 12px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 18px;

        }

        select.custom-select option {
            font-size: 18px;
        }

        .submit-btn {
            padding: 12px 25px;
            font-size: 18px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background-color: #255828;
        }

        .submit-btn:active {
            transform: scale(0.98);
            background-color: #388e3c;
        }

        .submit-btn:focus {
            outline: none;
        }

        .status-default {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .status-done {
            font-size: 18px;
            font-weight: bold;
            color: #2ecc71;
        }

        .status-loading {
            font-size: 18px;
            font-weight: bold;
        }

        .status-loading:after {
            display: inline-block;
            content: " CrewAI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô";
            animation: changeColor 3s infinite, dots 1.5s steps(4, end) infinite;
        }

        @keyframes changeColor {
            0% {
                color: #3498db;
            }

            33% {
                color: #2ecc71;
            }

            66% {
                color: #e74c3c;
            }

            100% {
                color: #3498db;
            }
        }

        @keyframes dots {
            0% {
                content: " CrewAI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô";
            }

            33% {
                content: " CrewAI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô.";
            }

            66% {
                content: " CrewAI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô..";
            }

            100% {
                content: " CrewAI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô...";
            }
        }

        .status-error {
            font-size: 18px;
            font-weight: bold;
            color: #e74c3c;

        }

        .status-default,
        .status-done,
        .status-error,
        .status-loading {
            text-align: center;
        }
        .result-container {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.15);
            text-align: center;  /* ‚úÖ ‡∏à‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô */
            max-width: 1500px;
            margin-left: auto;
            margin-right: auto;
            display: none;
        }
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: "Sour Gummy", serif;
            font-size: 20px;
            color: #333;
            line-height: 1.6;
            text-align: justify;  /* ‚úÖ ‡∏à‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô */
        }
        .Topic{
            text-align: center;
        }
    </style>
</head>

<body>
    <br>
    <h2 style="color:white; text-align:center;">CrewAI TRIP PLANNER</h2>
    <br>
    <img src="../pics/sun_stick.png" class="sticker" alt="Sticker" style="display:block; margin:auto;">
    <div class="container">
        <div class="form-group">
            <div class="custom-box">
                <div class="icon-box">
                    <span class="icon">üå¥</span>
                </div>
                <div class="content-box">
                    <h3 for="task-dropdown">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</h3>
                    <select id="task-dropdown" class="custom-select">
                        <option value="Phatthalung">üå¥ ‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á</option>
                        <option value="Satun">üåä ‡∏™‡∏ï‡∏π‡∏•</option>
                        <option value="Songkhla">üèñ ‡∏™‡∏á‡∏Ç‡∏•‡∏≤</option>
                        <option value="Trang">‚õ∞ ‡∏ï‡∏£‡∏±‡∏á</option>
                        <option value="Yala">üåÖ ‡∏¢‡∏∞‡∏•‡∏≤</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="form-group">
            <div class="custom-box">
                <div class="icon-box">
                    <span class="icon">üìä</span>
                </div>
                <div class="content-box">
                    <h3 for="Style-dropdown">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡πÑ‡∏ï‡∏•‡πå:</h3>
                    <select id="Style-dropdown" class="custom-select">
                        <option value="Any">üìä ‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö</option>
                        <option value="Cafe">‚òï ‡∏Ñ‡∏≤‡πÄ‡∏ü‡πà</option>
                        <option value="Extreme Activity">üí• ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏∏‡∏î‡∏Ç‡∏±‡πâ‡∏ß</option>
                        <option value="Historical">üè∞ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</option>
                        <option value="Natural">üå≥ ‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="form-group">
            <div class="custom-box">
                <div class="icon-box">
                    <span class="icon">üíµ</span>
                </div>
                <div class="content-box">
                    <h3 for="Cost-dropdown">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</h3>
                    <select id="Cost-dropdown" class="custom-select">
                        <option value="Any">üìä ‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤</option>
                        <option value="Low">üíµ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î</option>
                        <option value="Mid">üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                        <option value="High">üíé ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="form-group">
            <div class="custom-box">
                <div class="icon-box">
                    <span class="icon">üìÑ</span>
                </div>
                <div class="content-box">
                    <h3 for="Day-dropdown">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô:</h3>
                    <select id="Day-dropdown" class="custom-select">
                        <option value="Any">üîÑ ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option>  
                        <option value="1">üìÖ 1 ‡∏ß‡∏±‡∏ô</option>  
                        <option value="2">üìÜ 2 ‡∏ß‡∏±‡∏ô</option> 
                        <option value="3">‚è≥ 3 ‡∏ß‡∏±‡∏ô</option> 
                        <option value="4">üìÖ 4 ‡∏ß‡∏±‡∏ô</option> 
                        <option value="5">üìÜ 5 ‡∏ß‡∏±‡∏ô</option> 
                        <option value="6">üóìÔ∏è 6 ‡∏ß‡∏±‡∏ô</option>  
                        <option value="7">üìÜ 7 ‡∏ß‡∏±‡∏ô</option>  
                        <option value="more7">üìÖ ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 7 ‡∏ß‡∏±‡∏ô</option> 
                    </select>                    
                </div>
            </div>
        </div>

        <div class="form-group">
            <h3 for="adult" style="text-align: center;">‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà:</h3>
            <input type="text" id="adult" class="input-field" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà" />
        </div>

        <div class="form-group">
            <h3 for="rq" style="text-align: center;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:</h3>
            <input type="text" id="rq" class="input-field" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°" />
        </div>

        <button onclick="submitTask()" class="submit-btn">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
        <p id="task-status" class="status-default"></p>
    </div>
    <div class="result-container">
        <pre id="task-result"></pre>
    </div>
</body>
<script>

    function getRandomImage() {
        const images = [
            '../pics/2_6.jpg',
            '../pics/paktai10.jpg',
            '../pics/Song1.jpeg',
            '../pics/Song2.jpeg',
            '../pics/Song3.jpeg',
            '../pics/Song4.jpeg',
            '../pics/Song5.jpeg',
            '../pics/Song6.jpeg',
            '../pics/St1.jpeg',
            '../pics/St2.jpeg',
        ];


        // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°
        const randomIndex = Math.floor(Math.random() * images.length);
        const selectedImage = images[randomIndex];

        // ‡∏•‡∏ö‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏≠‡∏≤‡∏£‡πå‡πÄ‡∏£‡∏¢‡πå
        images.splice(randomIndex, 1);

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏†‡∏≤‡∏û‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        if (images.length === 0) return null; // ‡∏ñ‡πâ‡∏≤‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ null

        return selectedImage;

    }

    function formatResult(text) {

        // ‡πÅ‡∏ó‡∏£‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ Package
        text = text.replace(/Package \d+:.*?(\n|$)/g, (match) => {
            const finalImageUrl = getRandomImage(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ï‡∏≤‡∏° package index
            return `<div class="Topic">${match}</div> <img src="${finalImageUrl}" alt="Tourist Spot" style="width:600px; height:400px; display:block; margin: 20px auto; border-radius: 15px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); transition: transform 0.3s ease; " onmouseover="this.style.transform='scale(1.05)';" onmouseout="this.style.transform='scale(1)';">`;
        });
        // text = text.replace(/Night\)/gm, (match) => {
        //     const finalImageUrl = getRandomImage(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ï‡∏≤‡∏° package index
        //     return `${match} <img src="${finalImageUrl}" alt="Tourist Spot" style="width:600px; height:400px; display:block; margin: 20px auto; border-radius: 15px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); transition: transform 0.3s ease; " onmouseover="this.style.transform='scale(1.05)';" onmouseout="this.style.transform='scale(1)';">`;
        // });
        text = text.replace(/Afternoon/g, (match) => {
            return `<br><strong>${match}</strong>`;
        });
        text = text.replace(/Evening/g, (match) => {
            return `<br><strong>${match}</strong>`;
        });

        return text; // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    }

    async function submitTask() {
        const selectedTask = document.getElementById('task-dropdown').value;
        const selectedStyle = document.getElementById('Style-dropdown').value;
        const selectedCost = document.getElementById('Cost-dropdown').value;
        const selectedDay = document.getElementById('Day-dropdown').value;
        const Adults = document.getElementById('adult').value;
        const Rq = document.getElementById('rq').value;
        const statusEl = document.getElementById('task-status');
        const resultEl = document.getElementById('task-result');
        const resultContainer = document.querySelector('.result-container');

        if (!Adults) {
            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
            statusEl.classList.remove('status-default', 'status-loading', 'status-done');
            statusEl.classList.add('status-error');
            statusEl.innerText = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà!";
            return;
        }

        resultContainer.style.display = "none";
        // ‡∏•‡∏ö class ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° class ‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î
        statusEl.classList.remove('status-default', 'status-error', 'status-done');
        statusEl.classList.add('status-loading');  // ‡πÄ‡∏û‡∏¥‡πà‡∏° class ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î
        statusEl.innerText = "";  // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î
        resultEl.innerHTML = "";

        try {
            const response = await fetch('http://127.0.0.1:8000/set_task', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    task_type: selectedTask,
                    style: selectedStyle,
                    cost: selectedCost,
                    day: selectedDay,
                    adults: Adults,
                    Rq: Rq,
                })
            });

            const result = await response.json();

            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô
            statusEl.classList.remove('status-loading');
            statusEl.classList.add('status-done');
            statusEl.innerText = "‚úÖ Task ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!";

            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            resultContainer.style.display = "block";
            resultEl.innerHTML = formatResult(result.result);
        } catch (error) {
            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
            statusEl.classList.remove('status-loading', 'status-done');
            statusEl.classList.add('status-error');
            statusEl.innerText = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!";
            resultEl.innerText = error.message;
        }
    }
</script>

</body>

</html>